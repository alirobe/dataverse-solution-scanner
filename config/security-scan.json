{
  "$schema": "./security-scan.schema.json",
  "filetypes": [
    ".json",
    ".xml",
    ".js",
    ".ts",
    ".html",
    ".htm",
    ".css",
    ".yml",
    ".yaml",
    ".txt",
    ".xaml",
    ".resx"
  ],
  "rules": [
    {
      "id": "external-url",
      "severity": "Medium",
      "pattern": "(?i)(?<!xmlns=\")https?://[^\\s\\\"']+",
      "description": "Detects external URLs in code"
    },
    {
      "id": "potential-secret",
      "severity": "High",
      "pattern": "(?i)password|secret|api[-_ ]?key|token",
      "description": "Detects potential secrets or credentials"
    }
  ],
  "exemptions": {
    "external-url": [
      "https://@{outputs",
      "(?i)//www.w3.org",
      "(?i)//schema.management.azure.com",
      "(?i)//schemas.microsoft.com",
      "(?i)//go.microsoft.com",
      "(?i)//microsoft.com/appmagic"
    ],
    "potential-secret": [
      "(?i)IsDataSourceSecret",
      "PublicKeyToken",
      "skipToken",
      "TriggerWindowStartToken",
      "TriggerWindowEndToken",
      "TextInputCanvas_Type_",
      "(?i)X-MS-APIM-Tokens.*\\$ConnectionKey"
    ]
  }
}
